package com.usfb.balic.mergeupload;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FilenameFilter;
import java.io.InputStream;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import org.apache.commons.io.FilenameUtils;
import org.apache.log4j.Logger;

import com.bajaj.utility.utilityClass;
import com.itextpdf.text.Document;
import com.itextpdf.text.Image;
import com.itextpdf.text.pdf.PdfWriter;
import com.usfb.balic.process.GetPolicyDB;
import com.usfb.balic.process.insertToOmniDocDownloader;
import com.usfb.balic.ftpClient.FtpLoginClient;
public class ImageToPDFProcess {

	final static Logger log = Logger.getLogger(ImageToPDFProcess.class);
	static final String hostname_omni="balicdocs";
	static final String username_omni="UJIVAN_DOCS";
	static final String password_omni="Ox8Wna59K#u1Bef";
	static final String sourcepath="";
	static int port= 21;
	

	static final String destinationPath="D:\\UjjivanUSFB_new\\FTPFile\\";
	static insertToOmniDocDownloader insertToomniDocDownloader= new insertToOmniDocDownloader();
	static utilityClass utilityClass=new utilityClass();
	static Boolean flag=false;
	public static void main(String[] args) throws Exception 
	{
		
		String sourceImageForConvertToPdf = "//10.3.2.40/Extracted Data of all Location/Merging-Sep/OmniDocs/";	
		//String sourceImageForConvertToPdf ="D:\\UjjivanUSFB\\Manual\\";
		//String sourceImageForConvertToPdf = "10.3.2.40\\Extracted Data of all Location\\Merging-Sep\\OmniDocs_BKP\\";
		String destinationToStoreConvertedPDF = "D:\\UjjivanUSFB\\Manual_bkp\\";
	
		/*List<String> list=new ArrayList<String>();
		list.add("0339495505");
		list.add("0339468217");*/
		ArrayList<String> DocNamelist_sftp= new ArrayList<String>();
		DocNamelist_sftp.add("PROPOSAL FORM");
		DocNamelist_sftp.add("BI");
		//DocNamelist_sftp.add("RECEIPT");
		DocNamelist_sftp.add("KYC");
		DocNamelist_sftp.add("CDF");
     	//DocNamelist_sftp.add("RECENT_PHOTOGRAPH");
		/*ArrayList<String> DocNamelist= new ArrayList<String>();
		DocNamelist.add("PROPOSAL FORM");
		DocNamelist.add("BI");
		DocNamelist.add("RECEIPT");
		DocNamelist.add("AADHAAR CARD STANDARD");
		DocNamelist.add("PAN CARD");
		DocNamelist.add("PROP_M645");
		DocNamelist.add("OTH_M645");
		DocNamelist.add("CUSTOMER DECLARATION FORM");
		DocNamelist.add("RECENT_PHOTOGRAPH");*/
		// commented by harshali 
		
		ArrayList <String>  DocNamelist=new ArrayList <String>();
		DocNamelist=insertToomniDocDownloader.getListOfFromOmniDocDownloader(DocNamelist);
		//500-1 //"0347085000","0347268911","0342443397","0339252435","0342109895","0346957951","0347007261","0346870777","0340299820","0345507970","0342999361","0340730545","0343402326","0346975236","0342227728","0340643161","0345268134","0347546718","0345162812","0345223607","0346190126","0340610413","0346535765","0346911320","0348038724","0339626706","0342837114","0339368824","0339359650","0346872430","0347800593","0340652730","0348012060","0347613138","0344816644","0347851882","0342694018","0346130334","0345068647","0346918896","0346085124","0341825601","0344632174","0347577474","0347738060","0342277561","0343009133","0347881528","0339434483","0340641457","0340409355","0347637888","0347769751","0347805733","0339432681","0347817866","0343592215","0347555934","0341782255","0346082092","0342249306","0341437355","0342101846","0346871767","0345795055","0346718562","0341926466","0342252582","0338477836","0346117616","0342342315","0342297411","0343401957","0346100405","0347794171","0347871174","0340598281","0343721917","0344618151","0338430153","0341599702","0343638761","0347006903","0347672537","0346732460","0347551885","0337608617","0342288118","0347768975","0338412663","0348291248","0343745351","0346656293","0346104241","0340604726","0343870890","0343993204","0346081113","0340492071","0348004517","0341378005","0348368561","0346912955","0344643281","0339236622","0339337638","0346534650","0342101466","0345300055","0342226982","0347925636","0344423486","0347007870","0343907316","0342198792","0340219340","0340650405","0347276374","0339239061","0347577168","0342841950","0342100336","0338412942","0346102095","0340724908","0345792200","0343639953","0346872291","0344631932","0339992524","0344332242","0340654327","0339692058","0342222576","0345535131","0337550361","0346120624","0346718598","0348289726","0347711136","0346917680","0340308401","0341433623","0339251320","0341578416","0340897172","0341905500","0342980636","0347797165","0339495505","0347526538","0343993127","0347801684","0343962514","0345253055","0347799677","0339413960","0338593300","0342280174","0347768443","0347499950","0340061052","0348083440","0342344082","0347500281","0348040944","0342116901","0340788450","0342392451","0346991141","0347680154","0346228701","0345534596","0344072543","0346892394","0345269478","0339373040","0341444448","0340732258","0342219404","0343640333","0346120740","0343716487","0342431683","0340492727","0347501167","0347145480","0346914846","0346903412","0339477736","0339513011","0345419287","0345165058","0342227336","0341471510","0341953766","0341434777","0343718012","0343461508","0347262436","0340359652","0347825940","0339279193","0346873708","0343627390","0338414135","0347691828","0341846620","0346858087","0347928137","0346726862","0347470185","0343638963","0340644885","0347469513","0339512627","0339484502","0339685511","0343958897","0339724072","0340652436","0347498247","0346878751","0343919642","0340429306","0338595088","0343461663","0345542135","0338643574","0346850748","0342289946","0346903311","0343018385","0342226206","0344595846","0348018618","0342746402","0347026588","0347269610","0343722872","0347296453","0343750627","0347924521","0337629497","0347425418","0346088754","0346856196","0346534813","0344163840","0342342378","0343902975","0339454740","0347550553","0342227158","0342282395","0345299383","0348291616","0341386751","0346319654","0346105193","0343638684","0341846225","0341782130","0345412573","0348063358","0348083363","0346084805","0340729303","0343874835","0346498436","0345454417","0345255353","0344835706","0346702187","0345557470","0346535893","0342468376","0345163232","0346600876","0347871821","0345340846","0344105657","0347805555","0341601100","0347613456","0347587032","0347183768","0340648212","0338507742","0339585596","0342976781","0344175198","0346878002","0344002471","0338478003","0345328156","0342447802","0345254072","0346701425","0341370934","0339478676","0345792061","0339255483","0347318754","0347263275","0346917463","0346117631","0341271946","0347073512","0346154335","0347692046","0343640461","0342849401","0346861412","0346917576","0344625182","0338597828","0347716633","0345522501","0345794965","0347027034","0338785498","0346152976","0346181255","0347497714","0347722597","0346669683","0340319660","0342705800","0342734977","0341325268","0342392424","0343723354","0345522781","0345300613","0346534561","0344643052","0346724894","0345162444","0343469711","0342289364","0339569438","0346697097","0342693260","0348092210","0347296631","0339451678","0344462437","0340730584","0342846188","0346088614","0347689395","0346701654","0340651791","0347470336","0346915518","0345127946","0337567420","0348292467","0346190064","0347775221","0348088477","0338593262","0346813257","0348325584","0346856995","0343745782","0340717640","0339539245","0341867574","0343962755","0348136164","0346870334","0339682197","0339207850","0345163826","0344551261","0347806875","0344114846","0339582307","0346185560","0346153131","0344324004","0341510475","0347938192","0345268538","0344667496","0337610938","0348010888","0343797580","0341847355","0344536664","0342277825","0347814705","0347108696","0338071454","0339638931","0345115558","0346701437","0344216766","0346875540","0344823345","0341061484","0346661913","0342256768","0343897706","0339280838","0346189975","0339481330","0347249338","0339415343","0346602794","0346167853","0347768874","0341599854","0347022262","0343453592","0346896785","0347680484","0346084440","0347577206","0343970838","0347643397","0346208596","0345318713","0348116857","0341275731","0341288803","0341846148","0343722907","0346132543","0346991596","0343749207","0347713066","0343935277","0347261550","0338414058","0346875692","0343749641","0339634665","0346878992","0342807667","0339421473","0339251053","0342469125","0346872136","0338544725","0342227375","0341824204","0340035514","0342846672","0346409821","0347674176","0347635667","0346088971","0346221768","0342740206","0347832968","0345526575","0346537594","0340647246","0347099455","0340647870","0340644148","0341873222","0345300168","0346858036","0340498962","0346910948","0347556583","0347803373","0342837180","0342102088","0344339642","0340737526","0339207808","0338414391","0346917588","0343637694","0342226815","0347706718","0341276998","0347240935","0346872644","0347659124","0342094170","0346870245","0338415036","0341846861","0346089717","0348161977","0347966292","0343744144","0342843663","0346132011","0347023415","0340651458","0338071314","0342094333","0347919661"
		//1000-1 //"0347672754","0338070820","0348083158","0342279158","0338415101","0341905498","0347028137","0346381553","0347612873","0346184873","0344349108","0347799638","0340418990","0340729710","0344429058","0348144794","0343723544","0344641476","0344674538","0342358741","0347643361","0346184706","0341442456","0346857200","0348212064","0341440526","0341507583","0339568692","0337552911","0344074473","0342877350","0338412981","0344000158","0347834645","0341862852","0347047633","0343936130","0341445860","0347659810","0347636568","0338412826","0343935722","0341878211","0345542058","0347674330","0341949616","0339454865","0342439021","0342225193","0347503973","0347636758","0344623504","0344545942","0346893930","0339280978","0347852465","0342223806","0341905982","0344077315","0342224366","0339564060","0345571504","0347691602","0347800682","0339485008","0341447166","0346105178","0347103605","0339340192","0342846987","0345523720","0346892658","0342279211","0346813245","0347573680","0346917448","0344538745","0340730483","0346903056","0339512235","0347839518","0344535698","0347495761","0344332863","0346659631","0341824368","0345311301","0348010573","0340610704","0341104183","0343876183","0346152634","0346813310","0343646452","0344558685","0347981887","0339568905","0338071151","0340722881","0342096477","0348158972","0339482698","0342278536","0348154720","0346915444","0343694337","0346131770","0343992835","0346536033","0340414848","0340654087","0337861450","0348038510","0341824662","0343635788","0347213332","0344508703","0342693144","0339698126","0341434411","0338709168","0345526967","0342772573","0340319277","0346970312","0344551017","0338414007","0341952701","0346184466","0345803507","0342394951","0342812150","0337844923","0344400983","0344338590","0346917386","0338508821","0343816566","0345057314","0339634653","0347675938","0347579288","0340044323","0347163680","0343723797","0339255890","0344054367","0346169771","0341950392","0342849755","0341444703","0342433648","0339315148","0347875871","0343633822","0344620193","0348291720","0343992428","0348006144","0347843136","0345163170","0346109697","0341573810","0344177127","0341950442","0338598085","0344621982","0346497740","0342467828","0341318504","0346892572","0348501462","0347837538","0345340047","0345163942","0341846074","0339434901","0346537493","0341372608","0347690015","0347839471","0339626760","0342836543","0345054115","0337552201","0340651675","0341953005","0343780987","0346412283","0339468217","0342860620","0345229637","0345796945","0346497093","0340298827","0345257333","0343955092","0347852581","0340301114","0346915227","0347615742","0339529357","0344056071","0340725328","0346119698","0345557428","0343748030","0343875992","0343633695","0347267906","0339568020","0346184567","0348159380","0347880122","0338413398","0347687604","0337587167","0344624138","0348037265","0346132124","0346104568","0340655864","0346891617","0342467626","0342358334","0340726648","0348144933","0346850041","0347243083","0343722768","0347508617","0347007653","0342278753","0348045681","0346923147","0347557154","0344002064","0346888838","0346878267","0347017844","0346079704","0348209730","0348291667","0342467653","0347537075","0338595747","0339575125","0342226652","0341600906","0346133673","0341905206","0347579175","0339434471","0345450712","0341401055","0343723416","0346863621","0346876616","0339452897","0345340353","0341926531","0341271720","0340597897","0340699653","0348114508","0347756928","0346604254","0342357255","0338765801","0338830734","0339698203","0342711903","0345793633","0343692458","0347714118","0346857771","0338413614","0347884017","0339437388","0343935761","0340423898","0339208080","0342226563","0340597807","0343875270","0341944096","0346537683","0347573971","0339281157","0347777163","0341365453","0343638823","0339438381","0346855942","0345419694","0348145062","0342462284","0338071074","0343907468","0345802645","0343876726","0346168730","0347454030","0346870004","0342091491","0343784644","0343100795","0347664632","0346089578","0339528735","0346724828","0341946697","0340492487","0348038674","0345542388","0340043306","0347297075","0341434753","0346656800","0346991230","0341372787","0346657675","0341473794","0346914288","0340654253","0339657967","0341437432","0342288971","0347672424","0345164083","0340717500","0346915180","0343456663","0347536275","0340536048","0347889957","0337845584","0339568793","0339724728","0348215566","0346658968","0344818015","0344003155","0347818060","0342307006","0343645714","0342817858","0342252807","0338502916","0343034578","0346647216","0340652778","0342833181","0343875433","0341301460","0346892533","0346897763","0346185192","0342844196","0346186027","0348151165","0337586937","0342252338","0340512403","0347852631","0341068694","0347007793","0346652154","0347671182","0347485861","0340652591","0341325318","0337860445","0347691160","0342226738","0341840234","0339468624","0347577082","0341434613","0342700987","0344552720","0342849960","0346096496","0347613254","0346718003","0342282368","0344163864","0342271190","0347515508","0339533153","0346893903","0347774421","0340538536","0345256634","0344631614","0346660264","0346646900","0345561492","0340647501","0344632530","0342219378","0347029980","0339528521","0348286833","0347793790","0338503021","0347082942","0347995506","0338428554","0343910006","0346915506","0348291492","0346806226","0341952713","0347832273","0343723470","0341320193","0344535748","0343871508","0346669392","0345163155","0347490897","0346961910","0342456317","0343722480","0341066826","0346084526","0347545883","0346917540","0338412306","0347881861","0344534912","0337560537","0342722021","0347709727","0339557522","0347500661","0345340148","0342690857","0343078102","0347862291","0342289251","0345057784","0340594178","0340416638","0339441083","0347917716","0341508103","0341290554","0343639204","0347688280","0347928606","0339485047","0347778091","0339988084","0346914035","0341371568","0346914427","0341383715","0345257497","0347022731","0337608807","0344535445","0348456011","0346653171","0338595064","0348010383","0341601531","0337788951","0342694060","0342702462","0346129713","0342222374","0341434765","0340217523","0347843721","0342290264","0344395043","0347269091","0339568273","0347008438","0342102762","0340676084","0347163727","0341575675","0340346107","0347550642","0347660758","0347545247","0347155760","0345293466","0346697111","0346858455","0342711497","0341062070","0344359911","0341291024","0340492638","0348292330","0347839646","0345802482","0346120104","0347007816","0339359611","0347888931","0342980978","0340036504","0346158970","0344335046","0347561808","0345128381","0344648736","0338070782","0340725001","0348010953","0343936002","0346922172","0348291628","0341371048","0343864035","0346102703","0339990354","0339568781","0345444621","0347570493","0342843030","0339555364","0339634742","0347692198","0347573665","0347008251","0341845693","0344633761","0346089554","0338406417","0346152735","0347615793","0343032182","0347689243","0347110093","0347780195","0347801517","0342240372","0345163853","0339415444","0344095720","0347276335","0342227223","0346191384","0342836617","0343923803","0341836593","0340839547","0337596267","0347557103","0346922133","0347220871","0341828165","0347661395","0343461814","0345163128","0345162800","0343745755","0347007196","0347006776","0347483486","0341320686","0347532962","0339633042","0340389628","0343898925","0346102727","0346893612","0338593021","0343232376","0341840451","0347581065","0344634507","0342292458","0340217345","0345571531","0338410338","0339988883","0345410566","0342360720","0342223236","0344534785","0346617986","0342355150","0343402213","0346109533","0346942643","0346879587","0347844925","0339987878","0347268897","0340535135","0346131681","0343455165","0346167791","0343992990","0340162905","0342289934","0346298723","0342847193","0347008643","0342227425","0341610477","0339369473","0347452264","0348159706","0345571594","0342227298","0342842192","0340649924","0341067641","0346113718","0340733946","0340597822","0341866634","0347662156","0342438462","0343721983","0343461511","0346104948","0339209524","0347927756","0347182273","0347706668","0344485308","0343444643","0345798851","0342235675","0346535702","0346876147","0347318843","0341950302","0346872264","0346901723","0345420276","0342687356","0345256991","0347826407","0343444720","0347799400","0343909665","0341054198","0346185890","0342219277","0342862256","0347642790","0347318781","0347547091","0342818242","0348063878","0340407021","0342694006","0347129780","0348208458","0344530343","0347294167","0340389530","0347891191","0343893532","0343780381","0343872653","0341383831","0343470103","0346657690","0343754614","0347826663","0346131921","0340763560","0342862205","0343718470","0341603690","0347860260","0337663233","0340158492","0346656192","0343992330","0340651434","0342976362","0338429773","0343978762","0339457443","0341375291","0342877475","0344630993","0345346775","0340594092","0347007285","0348144312","0347579124","0346872998","0347773202","0343874140","0339630856","0343232058","0348291402","0339411790","0342250183","0347672778","0342840401","0337550498","0340868587","0343965547","0342219707","0342284728","0339411406","0342404546","0339568638","0346130272","0346897103","0347443924","0346896532","0347483132","0340647588","0347249454","0342289414","0342691176","0345445228","0347577994","0345557684","0348038662","0347794183","0341846112","0345572304","0340603484","0347543433","0347545704","0341371621","0341905664","0339631415","0347716087","0339414695","0347294078","0342687775","0337556705","0340725025","0344543148","0346892634","0339209512","0346871743","0347452380","0346871871","0345792643","0337552380","0347709692","0347318804","0345300970","0344623326","0346647980","0339988592","0343921811","0343627678","0340705326","0342393795","0342842937","0346912334","0343921265","0347556125","0340043550","0340190385","0346918290","0342093343","0346536390","0347547750","0343910627","0338408638","0345326672","0343588232","0345162735","0339694080","0348239047","0345300714","0340643348","0342844246","0341447142","0346102804","0347964870","0346597068","0347008275","0342253444","0340356857","0347433861","0342693842","0347797102","0347433911","0339725237","0342835247","0342836810","0340579037","0340041998","0343993433","0347659062","0342746441","0345163078","0346112996","0343074127","0343993775","0346862414","0346622175","0341933182","0347582738","0339478411","0342297970","0340599838","0346704410","0347996066","0346604230","0342489891","0343444503","0342249078","0347679991","0346892901","0345530193","0346134104","0346106132","0343706195","0338595192","0347688532","0347811432","0341072641","0341836325","0338174251","0345790865","0340652398","0342486261","0338454852","0339403766","0340417313","0343903255","0344069271","0343992898","0344535231","0347663324","0338411560","0346870994","0348004214","0345163205","0347708485","0342693055","0341578241","0346871770","0343647683","0346731137","0341383588","0346844645","0343959521","0347276400","0347888827","0347833884","0347550895","0339296364","0340313387","0342847953","0340307904","0337790333","0339988728","0347236456","0345558178","0346917487","0344361077","0342691571","0342277395","0346082130","0340491740","0346962948","0347200640","0346911484","0342849300","0346896277","0341950112","0338454014","0343500743","0342860163","0347029317","0348040894","0343402861","0347661115","0347268062","0341289883","0340495647","0346309778","0343906302","0344560284","0347659706","0346858761","0343962235","0347891137","0343875751","0339251585","0345162646","0345522475","0342226156","0346133420","0345301553","0338071175","0341053451","0348006257","0342093355","0340534882","0341952232","0346855725","0342223198","0346731734","0341303072","0347444320","0347689801","0342808101","0340644528","0340644721","0341507595","0345326951","0338545145","0340650952","0341950365","0347801470","0347737815","0343898495","0342848183","0345339985","0346874407","0339700956","0347526262","0340609754","0341599676","0342977313","0342091375","0345571516","0340652766","0339626567","0342220013","0340598355","0343610571","0347852248","0347680510","0344533896","0339369497","0342095564","0340487653","0341439703","0345162964","0347965631","0346118090","0342818506","0347081316","0347832754","0346082406","0347964362","0347006930","0341877117","0343976577","0346717521","0346860410","0347007032","0341471507","0341950718","0344858248","0346876554","0342884797","0343992292","0345526070","0346151695","0339512580","0347311874","0343701155","0345057481","0346104722","0346119178","0344533833","0346848543","0341817198","0341386888","0346845558","0345802924","0346131413","0346872962","0348086853","0342272557","0347546644","0347276323","0341953261","0346915278","0342227731","0344535181","0347671930","0347927340","0344546347","0341952788","0345560917","0346105344","0342978087","0345444898","0342694084","0344536310","0340415128","0347276424","0346661417"
		String arr[] = {"0347085000","0347268911","0342443397","0339252435","0342109895","0346957951","0347007261","0346870777","0340299820","0345507970","0342999361","0340730545","0343402326","0346975236","0342227728","0340643161","0345268134","0347546718","0345162812","0345223607","0346190126","0340610413","0346535765","0346911320","0348038724","0339626706","0342837114","0339368824","0339359650","0346872430","0347800593","0340652730","0348012060","0347613138","0344816644","0347851882","0342694018","0346130334","0345068647","0346918896","0346085124","0341825601","0344632174","0347577474","0347738060","0342277561","0343009133","0347881528","0339434483","0340641457","0340409355","0347637888","0347769751","0347805733","0339432681","0347817866","0343592215","0347555934","0341782255","0346082092","0342249306","0341437355","0342101846","0346871767","0345795055","0346718562","0341926466","0342252582","0338477836","0346117616","0342342315","0342297411","0343401957","0346100405","0347794171","0347871174","0340598281","0343721917","0344618151","0338430153","0341599702","0343638761","0347006903","0347672537","0346732460","0347551885","0337608617","0342288118","0347768975","0338412663","0348291248","0343745351","0346656293","0346104241","0340604726","0343870890","0343993204","0346081113","0340492071","0348004517","0341378005","0348368561","0346912955","0344643281","0339236622","0339337638","0346534650","0342101466","0345300055","0342226982","0347925636","0344423486","0347007870","0343907316","0342198792","0340219340","0340650405","0347276374","0339239061","0347577168","0342841950","0342100336","0338412942","0346102095","0340724908","0345792200","0343639953","0346872291","0344631932","0339992524","0344332242","0340654327","0339692058","0342222576","0345535131","0337550361","0346120624","0346718598","0348289726","0347711136","0346917680","0340308401","0341433623","0339251320","0341578416","0340897172","0341905500","0342980636","0347797165","0339495505","0347526538","0343993127","0347801684","0343962514","0345253055","0347799677","0339413960","0338593300","0342280174","0347768443","0347499950","0340061052","0348083440","0342344082","0347500281","0348040944","0342116901","0340788450","0342392451","0346991141","0347680154","0346228701","0345534596","0344072543","0346892394","0345269478","0339373040","0341444448","0340732258","0342219404","0343640333","0346120740","0343716487","0342431683","0340492727","0347501167","0347145480","0346914846","0346903412","0339477736","0339513011","0345419287","0345165058","0342227336","0341471510","0341953766","0341434777","0343718012","0343461508","0347262436","0340359652","0347825940","0339279193","0346873708","0343627390","0338414135","0347691828","0341846620","0346858087","0347928137","0346726862","0347470185","0343638963","0340644885","0347469513","0339512627","0339484502","0339685511","0343958897","0339724072","0340652436","0347498247","0346878751","0343919642","0340429306","0338595088","0343461663","0345542135","0338643574","0346850748","0342289946","0346903311","0343018385","0342226206","0344595846","0348018618","0342746402","0347026588","0347269610","0343722872","0347296453","0343750627","0347924521","0337629497","0347425418","0346088754","0346856196","0346534813","0344163840","0342342378","0343902975","0339454740","0347550553","0342227158","0342282395","0345299383","0348291616","0341386751","0346319654","0346105193","0343638684","0341846225","0341782130","0345412573","0348063358","0348083363","0346084805","0340729303","0343874835","0346498436","0345454417","0345255353","0344835706","0346702187","0345557470","0346535893","0342468376","0345163232","0346600876","0347871821","0345340846","0344105657","0347805555","0341601100","0347613456","0347587032","0347183768","0340648212","0338507742","0339585596","0342976781","0344175198","0346878002","0344002471","0338478003","0345328156","0342447802","0345254072","0346701425","0341370934","0339478676","0345792061","0339255483","0347318754","0347263275","0346917463","0346117631","0341271946","0347073512","0346154335","0347692046","0343640461","0342849401","0346861412","0346917576","0344625182","0338597828","0347716633","0345522501","0345794965","0347027034","0338785498","0346152976","0346181255","0347497714","0347722597","0346669683","0340319660","0342705800","0342734977","0341325268","0342392424","0343723354","0345522781","0345300613","0346534561","0344643052","0346724894","0345162444","0343469711","0342289364","0339569438","0346697097","0342693260","0348092210","0347296631","0339451678","0344462437","0340730584","0342846188","0346088614","0347689395","0346701654","0340651791","0347470336","0346915518","0345127946","0337567420","0348292467","0346190064","0347775221","0348088477","0338593262","0346813257","0348325584","0346856995","0343745782","0340717640","0339539245","0341867574","0343962755","0348136164","0346870334","0339682197","0339207850","0345163826","0344551261","0347806875","0344114846","0339582307","0346185560","0346153131","0344324004","0341510475","0347938192","0345268538","0344667496","0337610938","0348010888","0343797580","0341847355","0344536664","0342277825","0347814705","0347108696","0338071454","0339638931","0345115558","0346701437","0344216766","0346875540","0344823345","0341061484","0346661913","0342256768","0343897706","0339280838","0346189975","0339481330","0347249338","0339415343","0346602794","0346167853","0347768874","0341599854","0347022262","0343453592","0346896785","0347680484","0346084440","0347577206","0343970838","0347643397","0346208596","0345318713","0348116857","0341275731","0341288803","0341846148","0343722907","0346132543","0346991596","0343749207","0347713066","0343935277","0347261550","0338414058","0346875692","0343749641","0339634665","0346878992","0342807667","0339421473","0339251053","0342469125","0346872136","0338544725","0342227375","0341824204","0340035514","0342846672","0346409821","0347674176","0347635667","0346088971","0346221768","0342740206","0347832968","0345526575","0346537594","0340647246","0347099455","0340647870","0340644148","0341873222","0345300168","0346858036","0340498962","0346910948","0347556583","0347803373","0342837180","0342102088","0344339642","0340737526","0339207808","0338414391","0346917588","0343637694","0342226815","0347706718","0341276998","0347240935","0346872644","0347659124","0342094170","0346870245","0338415036","0341846861","0346089717","0348161977","0347966292","0343744144","0342843663","0346132011","0347023415","0340651458","0338071314","0342094333","0347919661"};	
		List<String> list = new ArrayList<String>();//GetPolicyDB.getPolicyNo();
		 list = Arrays.asList(arr);
		//List<String> list = new ArrayList<String> ();
		
		for(String policyNo : list) {
			log.info("Convert Image to PDF Policy No :" + policyNo);
		/*for(String DocName: DocNamelist)
		{
			String FIELD_NAME="PolicyNo";
			try {
				insertToomniDocDownloader.insertDataIntoOmniDocDownloader(DocName, FIELD_NAME, policyNo);				
			} 	
			catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}		
		}*/
		
		ArrayList <String>  dbDoclist= new ArrayList <String>();		
		dbDoclist = insertToomniDocDownloader.getStatusFromOmniDocDownloader(dbDoclist,policyNo);
		System.out.println(dbDoclist);
		 flag=utilityClass.equalLists(dbDoclist,DocNamelist);
		 System.out.println(flag);
			ArrayList <String> policyList = new ArrayList<String>();
			/*if(flag)
			{*/
		
			policyList.add(policyNo);
			
//			}
			
			com.bajaj.utility.utilityClass.CreateDirectoryStructure(destinationPath);
			FtpLoginClient FtpLoginClient = new FtpLoginClient(hostname_omni,port,username_omni,password_omni);
		
			System.out.println("policy no list ::::::::::::"+policyList);
			
		     FtpLoginClient.downloadFTPFile(sourcepath, destinationPath,policyList);
			
			 for(String policyno:policyList)
			 {
			new ImageToPDFProcess().converToPdfNew(policyno, destinationPath, destinationToStoreConvertedPDF);
			 }
		}
		System.out.println("done");
	}
	
	public void converToPdfNew(final String policyNo,String sourceLocation, String distinationLocation) throws ClassNotFoundException  
	{
			
		//String soucrceToMeregePDFList = "D:\\UjjivanUSFB\\Manual\\";
		//String distinationStoreMergePDF = "D:\\UjjivanUSFB\\MergeManualPDF\\"
			try {
				
				Document document = null;
				PdfWriter writer = null;
				
				File root = new File(sourceLocation);
				FilenameFilter beginswithPolicyNo = new FilenameFilter() {
					public boolean accept(File directory, String filename) {
						return filename.startsWith(policyNo.trim());
					}
				};
				System.out.println("FilenameFilter  ::::::   "+beginswithPolicyNo);
				ArrayList<String> listOf_filesName=new ArrayList<String>();	
				File[] files = root.listFiles();
				
				if(files.length>0)
				{	
						
						for (File f : files) 
						{		
							System.out.println("File Name = "+ f.getPath());
							
							if(f.isFile())
							{
								
								System.out.println(" File :::::::::::::" + f.getAbsolutePath());
								String fileName = f.getName();
								listOf_filesName.add(fileName);
								System.out.println("fileName " + fileName);
								log.info("File Name before converting image to pdf : "+fileName);
								String splitName[] = fileName.split("_");
								System.out.println("splitName0-->" + splitName[0]);
								String fileNameWithoutExtn = fileName.replaceFirst(
										"[.][^.]+$", "");
		
								System.out.println("fileNameWithoutExtn--> "
										+ fileNameWithoutExtn);
									if (policyNo.equalsIgnoreCase(splitName[0])) 
									{
										String extension = FilenameUtils
												.getExtension(fileName);
										System.out.println("Extension of the file: "
												+extension);
										
										File dir=new File(distinationLocation+"\\"+policyNo);
										//File dir=new File(distinationLocation);
										
										if(!dir.exists())
										{
											dir.mkdirs();
										}			
										if (extension.equalsIgnoreCase("bmp")|| extension.equalsIgnoreCase("TIF")
												|| extension.equalsIgnoreCase("jpg") 
												|| extension.equalsIgnoreCase("jpeg") || extension.equalsIgnoreCase("png")) 
										{
										    System.out.println("fileNameWithoutExtn ="+ fileNameWithoutExtn);
											// creating new Document for each file
											Image img = Image.getInstance(f.getPath());									
											img.setAbsolutePosition(0, 0);
											document = new Document(img);
											document.setPageSize(img);
											System.out.println(sourceLocation + fileName);
											String kyc_name=null;
											
											if(fileNameWithoutExtn.contains("AADHAAR CARD STANDARD") )
											{
												 kyc_name="KYC";
											}
											else if(fileNameWithoutExtn.contains("PAN CARD"))
											{
												kyc_name="ZKYC";
											}
											
											
											if(kyc_name!=null && !kyc_name.isEmpty()){
												String s[] = fileNameWithoutExtn.split("_");
												String kycDocs = s[0]+"_Y"+/*s[1]*/kyc_name;
												fileNameWithoutExtn = kycDocs;
											}
											
										
											File distFile=new File(dir.getPath()+"\\" + fileNameWithoutExtn+ ".pdf");
											
											
											String s[] = fileNameWithoutExtn.split("_");
											if(s[1].equalsIgnoreCase("YKYC") && distFile.exists()){
												fileNameWithoutExtn=distFile.getPath();
											}
											/*if(distFile.exists())
											{
												fileNameWithoutExtn=dir.getPath()+"\\" + fileNameWithoutExtn+ "_1.pdf";
											}*/
											//else
											//{
												fileNameWithoutExtn=distFile.getPath();
												System.out.println(fileNameWithoutExtn);
											//}
											FileOutputStream fos = new FileOutputStream(fileNameWithoutExtn);
											writer = PdfWriter.getInstance(document,
													fos);
											writer.open();
											document.open();
											document.add(img);
											document.close();
											writer.close();
										} 
										else if (extension.equalsIgnoreCase("pdf")) 
										{
											String s[] = fileNameWithoutExtn.split("_");
											if(s[1].contains("PROPOSAL FORM"))
											{
										
										  String propDocs = s[0]+"_B"+/*s[1]*/"PROPOSAL FORM";
										    fileNameWithoutExtn = propDocs;
											}
											InputStream in = new FileInputStream(new File(f.getPath()));
											
											File distFile=new File(dir.getPath()+"\\" + fileNameWithoutExtn+ ".pdf");
											/*if(distFile.exists())
											{
												fileNameWithoutExtn=dir.getPath()+"\\" + fileNameWithoutExtn+ "_1.pdf";
											}
											else
											{*/
												fileNameWithoutExtn=distFile.getPath();
											//}
											
											
											FileOutputStream out = new FileOutputStream(fileNameWithoutExtn);
											byte[] buffer = new byte[1024];
											int length;
											// copy the file content in bytes
											while ((length = in.read(buffer)) > 0) {
												out.write(buffer, 0, length);
											}
											in.close();
											out.close();
										}
										else 
										{
											System.out.println("File found other than jpg/bmp/jpeg/TIF/png :"+ fileName);
											log.info("File found other than jpg/bmp/jpeg/TIF/png :"+ fileName);
										}
									
									}
									else
									{
										System.out.println("policy number and fileName is not matched :" +policyNo+"***"+splitName[0]);
										log.info("policy number and fileName is not matched :" +policyNo+"***"+splitName[0]);
									}	
							}
							
						}
						
					//	mergePDFFiles(policyNo,soucrceToMeregePDFList,distinationStoreMergePDF);
			}
			else
			{
				System.out.println("No Pdf File on Server for that policy No ="+policyNo);
				log.info("No Pdf File on Server for that policy No ="+policyNo);
			}
				  

			} catch (Exception e) {
				e.printStackTrace();
			}
            
			
			
		}
}
